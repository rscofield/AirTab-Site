{!--       
     Author: John W. Blaine
     File Name: establishements_bottle.html
     
     Description :
     
     Example:
          
--}

{exp:airtab:log_page_load}


<div ng-cloak>
<div class="bar bar-subheader bar-dark slide-full" ng-if="$root.redeem">
  <h4 class="title smaller-title">Where you would like to redeem your drink?</h4>
</div>

<ion-view title="Establishments" ng-init="checkLogin();">
	<ion-nav-buttons side="{{$root.menuSide}}">
      <button menu-toggle="left" class="button button-icon icon ion-navicon"></button>
    </ion-nav-buttons>

    <ion-tabs class="tabs-striped tabs-background-assertive tabs-color-light" ng-controller="estBottleController">

	  <ion-tab title="All Establishments" on-select="loadEstablishments( '{segment_6}' );">
	  	<ion-content has-header="true" padding="true" has-tabs="true" delegate-handle="scrollCtrl" ng-init="doScroll()" ng-class="($root.redeem) ? 'has-subheader' : ''">
	  		<ion-refresher
			    pulling-text="Pull to refresh..."
			    on-refresh="doRefresh()">
			</ion-refresher>
			<div ng-if="$root.location.status == 'disabled'" style="text-align:center">
				<h3>You do not have Location Services enabled.</h3>
				<button ng-click="showLocationPrefs()">Enable Location Services</button>
			</div>
			<div style="width:100%" id="widthTest">
				<input ng-model="query" placeholder="Search">
			</div>
			
	  	<div ng-repeat="est in estWithBottle | filter:query">
		    	<div class="list card" ng-click="showEstMenu({{est.id}}, '{segment_3}', '{segment_4}', '{segment_5}', '{segment_6}');">
		    		
					<div class="item item-image">
						<img src="{{est.bg}}" width="100%" ng-style="{height: getImageHeight()}">
					</div>

					
					<div class="item" style="text-align:center">
					<h2 center>
						{{est.title}}
					</h2>
					{{est.distance}}
					</div>
										
				</div>
			</div>
		</ion-content>
	  </ion-tab>


	</ion-tabs>	
</ion-view>
</div>




